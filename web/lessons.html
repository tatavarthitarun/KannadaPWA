<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kannada PWA - Phase 7: Full Lesson Interface</title>
    <meta name="description" content="Learn Kannada with interactive lessons and exercises">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#764ba2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Kannada PWA">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .lesson-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .lesson-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
        }
        
        .lesson-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .lesson-header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .lesson-meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.2);
            padding: 10px 15px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }
        
        .meta-item span:first-child {
            font-size: 1.2rem;
        }
        
        .meta-item span:last-child {
            font-weight: 500;
        }
        
        .lesson-content {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .content-section {
            margin-bottom: 30px;
        }
        
        .content-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .letter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .letter-card {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .letter-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .letter-kannada {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .letter-telugu {
            font-size: 1.8rem;
            margin-bottom: 8px;
        }
        
        .letter-english {
            font-size: 1.2rem;
            margin-bottom: 8px;
        }
        
        .letter-pronunciation {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .exercise-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .exercise-question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #333;
        }
        
        .exercise-options {
            display: grid;
            gap: 15px;
        }
        
        .exercise-option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        .exercise-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .exercise-option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .exercise-option.correct {
            border-color: #28a745;
            background: #28a745;
            color: white;
        }
        
        .exercise-option.incorrect {
            border-color: #dc3545;
            background: #dc3545;
            color: white;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 5px;
            transition: width 0.3s ease;
        }
        
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 10px 5px;
            animation: bounce 0.6s ease;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .feedback-message {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 600;
            text-align: center;
        }
        
        .feedback-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .feedback-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        @media (max-width: 768px) {
            .lesson-container {
                padding: 15px;
            }
            
            .lesson-title {
                font-size: 2rem;
            }
            
            .lesson-meta {
                flex-direction: column;
                align-items: center;
            }
            
            .letter-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 15px;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }
        }

        .btn-back {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 20px;
            transition: background-color 0.3s;
        }
        
        .btn-back:hover {
            background: #5a6268;
        }
        
        .lesson-navigation {
            margin-bottom: 20px;
        }
        
        .vowel-display {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .main-vowel {
            font-size: 4rem;
            color: #764ba2;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .vowel-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .detail-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .detail-item .label {
            font-weight: bold;
            color: #6c757d;
            display: block;
            margin-bottom: 5px;
        }
        
        .detail-item .value {
            font-size: 1.2rem;
            color: #333;
        }
        
        .examples-section {
            margin-bottom: 30px;
        }
        
        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .example-word {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .example-word .kannada {
            font-size: 1.5rem;
            color: #1976d2;
            display: block;
            margin-bottom: 5px;
        }
        
        .example-word .telugu {
            font-size: 1.2rem;
            color: #388e3c;
            display: block;
            margin-bottom: 5px;
        }
        
        .example-word .english {
            color: #666;
            font-style: italic;
        }
        
        .writing-practice {
            margin-bottom: 30px;
        }
        
        .writing-area {
            text-align: center;
        }
        
        #writing-canvas {
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
            margin-bottom: 15px;
            cursor: crosshair;
        }
        
        .writing-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .btn-small {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-small:hover {
            background: #218838;
        }

        .vowels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .letter-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .letter-card:hover {
            transform: translateY(-5px);
            border-color: #667eea;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        
        .letter-kannada {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .letter-telugu {
            font-size: 1.5rem;
            color: #388e3c;
            margin-bottom: 8px;
        }
        
        .letter-english {
            font-size: 1rem;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .letter-pronunciation {
            font-size: 0.9rem;
            color: #888;
            font-style: italic;
            line-height: 1.3;
        }
        
        /* Responsive grid adjustments */
        @media (max-width: 768px) {
            .vowels-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 12px;
            }
            
            .letter-card {
                padding: 15px;
            }
            
            .letter-kannada {
                font-size: 2rem;
            }
            
            .letter-telugu {
                font-size: 1.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .vowels-grid {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
                gap: 10px;
            }
            
            .letter-card {
                padding: 12px;
            }
            
            .letter-kannada {
                font-size: 1.8rem;
            }
            
            .letter-telugu {
                font-size: 1rem;
            }
            
            .letter-english {
                font-size: 0.9rem;
            }
            
            .letter-pronunciation {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="lesson-container">
        <!-- Lesson Title -->
        <div class="lesson-header" id="lesson-title">
            <h1>🔤 Kannada Vowels Lesson</h1>
            <p class="subtitle">Learn all 13 vowels (ಸ್ವರಗಳು) of Kannada alphabet</p>
            <div class="lesson-meta">
                <div class="meta-item">
                    <span>⏱️</span>
                    <span>15 minutes</span>
                </div>
                <div class="meta-item">
                    <span>🎯</span>
                    <span>BEGINNER</span>
                </div>
                <div class="meta-item">
                    <span>📚</span>
                    <span>13 vowels</span>
                </div>
            </div>
        </div>
        
        <!-- Vowels Grid -->
        <div class="content-section">
            <h3>🔤 Vowels Grid</h3>
            <div class="vowels-grid" id="vowels-grid">
                <!-- Vowels will be populated by JavaScript -->
            </div>
        </div>
        
        <!-- Lesson Content -->
        <div class="lesson-content" id="lesson-interface" style="display: none;">
            <div class="content-section">
                <div class="lesson-navigation">
                    <button onclick="goBackToVowels()" class="btn-back">← Back to Vowels</button>
                </div>
                <div id="lesson-content">
                    <!-- Lesson content will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Exercise Section -->
        <div class="content-section" id="practice-section" style="display: none;">
            <h3>🧠 Practice Exercise</h3>
            <div class="exercise-section">
                <div class="exercise-question" id="exercise-question">
                    Click "Start Exercise" to begin practicing!
                </div>
                <div class="exercise-options" id="exercise-options">
                    <!-- Exercise options will be populated by JavaScript -->
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="exercise-progress" style="width: 0%"></div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" id="start-exercise">Start Exercise</button>
                    <button class="btn" id="check-answer" style="display: none;">Check Answer</button>
                    <button class="btn" id="next-question" style="display: none;">Next Question</button>
                </div>
            </div>
        </div>
        
        <!-- Achievement Section -->
        <div class="content-section">
            <h3>🏆 Achievements</h3>
            <div id="achievements-container">
                <div class="achievement-badge">🎯 First Vowel Learned</div>
                <div class="achievement-badge">🔤 5 Vowels Mastered</div>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="navigation-buttons">
            <button class="btn" id="prev-lesson" onclick="goToPreviousLesson()">← Previous Lesson</button>
            <button class="btn" id="next-lesson" onclick="goToNextLesson()">Next Lesson →</button>
        </div>
    </div>

    <script>
        // Lesson data
        const lessonData = {
            vowels: [
                { kannada: "ಅ", telugu: "అ", english: "a", pronunciation: "ah (like 'a' in 'about')" },
                { kannada: "ಆ", telugu: "ఆ", english: "aa", pronunciation: "aa (like 'a' in 'father')" },
                { kannada: "ಇ", telugu: "ఇ", english: "i", pronunciation: "ee (like 'i' in 'bit')" },
                { kannada: "ಈ", telugu: "ఈ", english: "ii", pronunciation: "ee (like 'ee' in 'see')" },
                { kannada: "ಉ", telugu: "ఉ", english: "u", pronunciation: "oo (like 'u' in 'put')" },
                { kannada: "ಊ", telugu: "ఊ", english: "uu", pronunciation: "oo (like 'oo' in 'moon')" },
                { kannada: "ಋ", telugu: "ఋ", english: "ri", pronunciation: "ri (like 'ri' in 'river')" },
                { kannada: "ಎ", telugu: "ఎ", english: "e", pronunciation: "e (like 'e' in 'bed')" },
                { kannada: "ಏ", telugu: "ఏ", english: "ee", pronunciation: "ay (like 'ay' in 'say')" },
                { kannada: "ಐ", telugu: "ఐ", english: "ai", pronunciation: "ai (like 'ai' in 'aisle')" },
                { kannada: "ಒ", telugu: "ఒ", english: "o", pronunciation: "o (like 'o' in 'go')" },
                { kannada: "ಓ", telugu: "ఓ", english: "oo", pronunciation: "o (like 'o' in 'go')" },
                { kannada: "ಔ", telugu: "ఔ", english: "au", pronunciation: "au (like 'ow' in 'cow')" }
            ]
        };
        
        // Exercise state
        let currentExercise = 0;
        let selectedAnswer = null;
        let correctAnswers = 0;
        let totalQuestions = 0;
        
        // Initialize the lesson
        function initializeLesson() {
            populateVowels();
            setupExerciseSystem();
            console.log('🎓 Phase 7: Full Lesson Interface initialized!');
        }
        
        // Populate vowels grid
        function populateVowels() {
            const grid = document.getElementById('vowels-grid');
            grid.innerHTML = '';
            
            lessonData.vowels.forEach((vowel, index) => {
                const card = document.createElement('div');
                card.className = 'letter-card';
                card.innerHTML = `
                    <div class="letter-kannada">${vowel.kannada}</div>
                    <div class="letter-telugu">${vowel.telugu}</div>
                    <div class="letter-english">${vowel.english}</div>
                    <div class="letter-pronunciation">${vowel.pronunciation}</div>
                `;
                card.onclick = () => practiceVowel(vowel, index);
                grid.appendChild(card);
            });
        }
        
        // Practice individual vowel
        function practiceVowel(vowel, index) {
            console.log(`🔤 Practicing vowel: ${vowel.kannada}`);
            
            // Hide the vowels grid and show the lesson interface
            document.getElementById('vowels-grid').style.display = 'none';
            document.getElementById('lesson-interface').style.display = 'block';
            
            // Populate the lesson interface with vowel details
            populateLessonInterface(vowel, index);
        }
        
        // Populate lesson interface with vowel details
        function populateLessonInterface(vowel, index) {
            const lessonTitle = document.getElementById('lesson-title');
            const lessonContent = document.getElementById('lesson-content');
            const practiceSection = document.getElementById('practice-section');
            
            // Get unique examples for this vowel
            const examples = getVowelExamples(vowel.kannada);
            
            // Update lesson title
            lessonTitle.innerHTML = `
                <h1>🔤 Learning Vowel: ${vowel.kannada}</h1>
                <p class="subtitle">Position ${index + 1} in Kannada Alphabet</p>
            `;
            
            // Update lesson content
            lessonContent.innerHTML = `
                <div class="lesson-card">
                    <div class="vowel-display">
                        <div class="main-vowel">${vowel.kannada}</div>
                        <div class="vowel-details">
                            <div class="detail-item">
                                <span class="label">Telugu:</span>
                                <span class="value">${vowel.telugu}</span>
                            </div>
                            <div class="detail-item">
                                <span class="label">English:</span>
                                <span class="value">${vowel.english}</span>
                            </div>
                            <div class="detail-item">
                                <span class="label">Pronunciation:</span>
                                <span class="value">${vowel.pronunciation}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="examples-section">
                        <h3>📝 Examples in Words</h3>
                        <div class="examples-grid">
                            ${examples.map(example => `
                                <div class="example-word">
                                    <span class="kannada">${example.kannada}</span>
                                    <span class="telugu">${example.telugu}</span>
                                    <span class="english">${example.english}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="writing-practice">
                        <h3>✍️ Writing Practice</h3>
                        <div class="writing-area">
                            <canvas id="writing-canvas" width="300" height="200"></canvas>
                            <div class="writing-controls">
                                <button onclick="clearCanvas()" class="btn-small">Clear</button>
                                <button onclick="checkWriting()" class="btn-small">Check</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Show practice section
            practiceSection.style.display = 'block';
            
            // Initialize writing canvas
            initializeWritingCanvas();
        }
        
        // Get unique examples for each vowel
        function getVowelExamples(kannadaVowel) {
            const examples = {
                'ಅ': [
                    { kannada: 'ಅಮ್ಮ', telugu: 'అమ్మ', english: 'amma (mother)' },
                    { kannada: 'ಅಪ್ಪ', telugu: 'అప్ప', english: 'appa (father)' },
                    { kannada: 'ಅಕ್ಕ', telugu: 'అక్క', english: 'akka (elder sister)' }
                ],
                'ಆ': [
                    { kannada: 'ಆಕಾಶ', telugu: 'ఆకాశం', english: 'aakasha (sky)' },
                    { kannada: 'ಆನೆ', telugu: 'ఆనె', english: 'aane (elephant)' },
                    { kannada: 'ಆರೋಗ್ಯ', telugu: 'ఆరోగ్యం', english: 'aarogya (health)' }
                ],
                'ಇ': [
                    { kannada: 'ಇಲಿ', telugu: 'ఇలి', english: 'ili (mouse)' },
                    { kannada: 'ಇದು', telugu: 'ఇది', english: 'idu (this)' },
                    { kannada: 'ಇಂದು', telugu: 'ఇన్నాడు', english: 'indu (today)' }
                ],
                'ಈ': [
                    { kannada: 'ಈಗ', telugu: 'ఈగ', english: 'eega (now)' },
                    { kannada: 'ಈರುಳ್ಳಿ', telugu: 'ఈరుల్లి', english: 'eerulli (onion)' },
                    { kannada: 'ಈಶ್ವರ', telugu: 'ఈశ్వరుడు', english: 'eeshwara (god)' }
                ],
                'ಉ': [
                    { kannada: 'ಉಪ್ಪು', telugu: 'ఉప్పు', english: 'uppu (salt)' },
                    { kannada: 'ಉಳಿದ', telugu: 'ఉలిసిన', english: 'ulida (remaining)' },
                    { kannada: 'ಉತ್ತರ', telugu: 'ఉత్తరం', english: 'uttara (answer)' }
                ],
                'ಊ': [
                    { kannada: 'ಊರು', telugu: 'ఊరు', english: 'ooru (village)' },
                    { kannada: 'ಊಟ', telugu: 'ఊట', english: 'oota (meal)' },
                    { kannada: 'ಊರಿಗೆ', telugu: 'ఊరికి', english: 'oorige (to village)' }
                ],
                'ಋ': [
                    { kannada: 'ಋತು', telugu: 'ఋతువు', english: 'ritu (season)' },
                    { kannada: 'ಋಷಿ', telugu: 'ఋషి', english: 'rishi (sage)' },
                    { kannada: 'ಋಣ', telugu: 'ఋణం', english: 'rina (debt)' }
                ],
                'ಎ': [
                    { kannada: 'ಎಲೆ', telugu: 'ఎల', english: 'ele (leaf)' },
                    { kannada: 'ಎಲ್ಲ', telugu: 'ఎల్ల', english: 'ella (all)' },
                    { kannada: 'ಎತ್ತು', telugu: 'ఎత్తు', english: 'ettu (height)' }
                ],
                'ಏ': [
                    { kannada: 'ಏನು', telugu: 'ఏమి', english: 'enu (what)' },
                    { kannada: 'ಏಳು', telugu: 'ఏడు', english: 'elu (seven)' },
                    { kannada: 'ಏಕೆ', telugu: 'ఎందుకు', english: 'eke (why)' }
                ],
                'ಐ': [
                    { kannada: 'ಐದು', telugu: 'అయిదు', english: 'aidu (five)' },
                    { kannada: 'ಐಶ್ವರ್ಯ', telugu: 'ఐశ్వర్యం', english: 'aishwarya (wealth)' },
                    { kannada: 'ಐತಿಹಾಸಿಕ', telugu: 'చారిత్రక', english: 'aitihasika (historical)' }
                ],
                'ಒ': [
                    { kannada: 'ಒಂದು', telugu: 'ఒక్కటి', english: 'ondu (one)' },
                    { kannada: 'ಒಳಗೆ', telugu: 'లోపల', english: 'olage (inside)' },
                    { kannada: 'ಒತ್ತು', telugu: 'ఒత్తు', english: 'ottu (press)' }
                ],
                'ಓ': [
                    { kannada: 'ಓದು', telugu: 'చదువు', english: 'odu (read)' },
                    { kannada: 'ಓಡು', telugu: 'పరుగు', english: 'odu (run)' },
                    { kannada: 'ಓಣಿ', telugu: 'వీధి', english: 'oni (street)' }
                ],
                'ಔ': [
                    { kannada: 'ಔಷಧ', telugu: 'ఔషధం', english: 'aushadha (medicine)' },
                    { kannada: 'ಔಚಿತ್ಯ', telugu: 'ఔచిత్యం', english: 'auchitya (appropriateness)' },
                    { kannada: 'ಔದಾರ್ಯ', telugu: 'ఔదార్యం', english: 'audarya (generosity)' }
                ]
            };
            
            return examples[kannadaVowel] || examples['ಅ']; // Default to 'ಅ' examples if not found
        }
        
        // Initialize writing canvas for practice
        function initializeWritingCanvas() {
            const canvas = document.getElementById('writing-canvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;
            
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            function startDrawing(e) {
                isDrawing = true;
                [lastX, lastY] = [e.offsetX, e.offsetY];
            }
            
            function draw(e) {
                if (!isDrawing) return;
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(e.offsetX, e.offsetY);
                ctx.stroke();
                [lastX, lastY] = [e.offsetX, e.offsetY];
            }
            
            function stopDrawing() {
                isDrawing = false;
            }
        }
        
        // Clear writing canvas
        function clearCanvas() {
            const canvas = document.getElementById('writing-canvas');
            if (canvas) {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
        }
        
        // Check writing (simplified)
        function checkWriting() {
            alert('Great effort! Keep practicing writing this vowel. The more you practice, the better you\'ll get!');
        }
        
        // Go back to vowels grid
        function goBackToVowels() {
            document.getElementById('lesson-interface').style.display = 'none';
            document.getElementById('vowels-grid').style.display = 'grid';
        }
        
        // Setup exercise system
        function setupExerciseSystem() {
            const startBtn = document.getElementById('start-exercise');
            const checkBtn = document.getElementById('check-answer');
            const nextBtn = document.getElementById('next-question');
            
            startBtn.onclick = startExercise;
            checkBtn.onclick = checkAnswer;
            nextBtn.onclick = nextQuestion;
        }
        
        // Start exercise
        function startExercise() {
            currentExercise = 0;
            correctAnswers = 0;
            totalQuestions = 5;
            
            document.getElementById('start-exercise').style.display = 'none';
            document.getElementById('check-answer').style.display = 'inline-block';
            
            showQuestion();
        }
        
        // Show current question
        function showQuestion() {
            const questionEl = document.getElementById('exercise-question');
            const optionsEl = document.getElementById('exercise-options');
            
            const currentVowel = lessonData.vowels[currentExercise];
            const questionTypes = [
                {
                    question: `What is the Telugu equivalent of ${currentVowel.kannada}?`,
                    correct: currentVowel.telugu,
                    options: generateOptions(currentVowel.telugu, 'telugu')
                },
                {
                    question: `What is the English equivalent of ${currentVowel.kannada}?`,
                    correct: currentVowel.english,
                    options: generateOptions(currentVowel.english, 'english')
                },
                {
                    question: `Which vowel has the pronunciation: "${currentVowel.pronunciation}"?`,
                    correct: currentVowel.kannada,
                    options: generateOptions(currentVowel.kannada, 'kannada')
                }
            ];
            
            const questionType = questionTypes[currentExercise % 3];
            questionEl.textContent = questionType.question;
            
            optionsEl.innerHTML = '';
            questionType.options.forEach((option, index) => {
                const optionEl = document.createElement('div');
                optionEl.className = 'exercise-option';
                optionEl.textContent = option;
                optionEl.onclick = () => selectOption(optionEl, option);
                optionsEl.appendChild(optionEl);
            });
            
            updateProgress();
        }
        
        // Generate exercise options
        function generateOptions(correct, type) {
            const options = [correct];
            
            if (type === 'telugu') {
                const teluguChars = ['అ', 'ఆ', 'ఇ', 'ఈ', 'ఉ', 'ఊ', 'ఎ', 'ఏ', 'ఐ', 'ఒ', 'ఓ', 'ఔ'];
                while (options.length < 4) {
                    const randomChar = teluguChars[Math.floor(Math.random() * teluguChars.length)];
                    if (!options.includes(randomChar)) {
                        options.push(randomChar);
                    }
                }
            } else if (type === 'english') {
                const englishChars = ['a', 'ā', 'i', 'ī', 'u', 'ū', 'e', 'ē', 'ai', 'o', 'ō', 'au'];
                while (options.length < 4) {
                    const randomChar = englishChars[Math.floor(Math.random() * englishChars.length)];
                    if (!options.includes(randomChar)) {
                        options.push(randomChar);
                    }
                }
            } else {
                const kannadaChars = ['ಅ', 'ಆ', 'ಇ', 'ಈ', 'ಉ', 'ಊ', 'ಎ', 'ಏ', 'ಐ', 'ಒ', 'ಓ', 'ಔ'];
                while (options.length < 4) {
                    const randomChar = kannadaChars[Math.floor(Math.random() * kannadaChars.length)];
                    if (!options.includes(randomChar)) {
                        options.push(randomChar);
                    }
                }
            }
            
            // Shuffle options
            return options.sort(() => Math.random() - 0.5);
        }
        
        // Select option
        function selectOption(optionEl, option) {
            // Clear previous selection
            document.querySelectorAll('.exercise-option').forEach(el => {
                el.classList.remove('selected');
            });
            
            optionEl.classList.add('selected');
            selectedAnswer = option;
        }
        
        // Check answer
        function checkAnswer() {
            if (selectedAnswer === null) {
                alert('Please select an answer first!');
                return;
            }
            
            const currentVowel = lessonData.vowels[currentExercise];
            const questionType = currentExercise % 3;
            let correct = '';
            
            if (questionType === 0) correct = currentVowel.telugu;
            else if (questionType === 1) correct = currentVowel.english;
            else correct = currentVowel.kannada;
            
            const isCorrect = selectedAnswer === correct;
            
            if (isCorrect) {
                correctAnswers++;
                showFeedback('Correct! Well done! 🎉', 'success');
            } else {
                showFeedback(`Incorrect. The correct answer is: ${correct}`, 'error');
            }
            
            // Mark options
            document.querySelectorAll('.exercise-option').forEach(el => {
                if (el.textContent === correct) {
                    el.classList.add('correct');
                } else if (el.textContent === selectedAnswer && !isCorrect) {
                    el.classList.add('incorrect');
                }
            });
            
            document.getElementById('check-answer').style.display = 'none';
            document.getElementById('next-question').style.display = 'inline-block';
        }
        
        // Next question
        function nextQuestion() {
            currentExercise++;
            
            if (currentExercise >= totalQuestions) {
                finishExercise();
            } else {
                showQuestion();
                document.getElementById('check-answer').style.display = 'inline-block';
                document.getElementById('next-question').style.display = 'none';
                selectedAnswer = null;
                
                // Clear option styling
                document.querySelectorAll('.exercise-option').forEach(el => {
                    el.classList.remove('selected', 'correct', 'incorrect');
                });
            }
        }
        
        // Finish exercise
        function finishExercise() {
            const score = Math.round((correctAnswers / totalQuestions) * 100);
            const message = `Exercise completed! 🎉\n\nScore: ${score}%\nCorrect: ${correctAnswers}/${totalQuestions}`;
            
            alert(message);
            
            // Reset exercise
            document.getElementById('start-exercise').style.display = 'inline-block';
            document.getElementById('check-answer').style.display = 'none';
            document.getElementById('next-question').style.display = 'none';
            document.getElementById('exercise-question').textContent = 'Click "Start Exercise" to begin practicing!';
            document.getElementById('exercise-options').innerHTML = '';
            document.getElementById('exercise-progress').style.width = '0%';
            
            // Show achievements
            if (score >= 80) {
                showAchievement('🎯 Exercise Master!', 'Completed exercise with 80%+ score');
            }
        }
        
        // Update progress
        function updateProgress() {
            const progress = (currentExercise / totalQuestions) * 100;
            document.getElementById('exercise-progress').style.width = progress + '%';
        }
        
        // Show feedback
        function showFeedback(message, type) {
            const feedbackEl = document.createElement('div');
            feedbackEl.className = `feedback-message feedback-${type}`;
            feedbackEl.textContent = message;
            
            const exerciseSection = document.querySelector('.exercise-section');
            exerciseSection.insertBefore(feedbackEl, exerciseSection.querySelector('.progress-bar'));
            
            setTimeout(() => {
                feedbackEl.remove();
            }, 3000);
        }
        
        // Show achievement
        function showAchievement(title, description) {
            const achievementEl = document.createElement('div');
            achievementEl.className = 'achievement-badge';
            achievementEl.textContent = title;
            achievementEl.title = description;
            
            document.getElementById('achievements-container').appendChild(achievementEl);
            
            setTimeout(() => {
                achievementEl.remove();
            }, 5000);
        }
        
        // Navigation functions
        function goToPreviousLesson() {
            alert('This would navigate to the previous lesson in Phase 8!');
        }
        
        function goToNextLesson() {
            alert('This would navigate to the next lesson in Phase 8!');
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('📚 Lessons page loaded, waiting for Kotlin code...');
            waitForKotlinAndInitialize();
        });
        
        // Wait for Kotlin code to load and then initialize
        function waitForKotlinAndInitialize() {
            if (typeof window.KannadaPWA !== 'undefined') {
                console.log('✅ Kotlin code loaded, initializing lesson interface...');
                initializeLesson();
            } else {
                console.log('⏳ Waiting for Kotlin code to load...');
                setTimeout(waitForKotlinAndInitialize, 100);
            }
        }
        
        console.log('🚀 Phase 7: Full Lesson Interface loaded successfully!');
    </script>
    
    <!-- Load our Kotlin/JS bundle -->
    <script src="KannadaPWA.js"></script>
</body>
</html>
